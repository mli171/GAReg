% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gareg_knots.R
\name{fixknotsIC}
\alias{fixknotsIC}
\title{Information criterion for a fixedâ€“knot B-spline regression}
\usage{
fixknotsIC(
  knot_bin,
  plen = 0,
  y,
  x,
  x_unique,
  x_base = NULL,
  fixedknots,
  polydegree = 3L,
  ic_method = "BIC"
)
}
\arguments{
\item{knot_bin}{Integer vector (chromosome). The first element may be ignored
in a fixed-\eqn{m} setup; the next \eqn{m} elements are **indices into**
\code{x_unique} selecting the interior knots:
\code{knot_bin[2L:(1L + m)]}. Indices must refer to interior candidates
\code{2:(length(x_unique)-1)}. Non-finite, duplicate, out-of-range, or
boundary indices cause the function to return \code{Inf}.}

\item{plen}{Unused placeholder kept for API compatibility with other
objective functions. Ignored.}

\item{y}{Numeric response vector of length \eqn{n}.}

\item{x}{Numeric predictor (same length as \code{y}) on which the spline
basis is built.}

\item{x_unique}{Optional numeric vector of unique candidate knot locations.
If \code{NULL} or missing, it defaults to \code{sort(unique(x))}. Must
contain at least \eqn{m + 2} values (interior + two boundaries).}

\item{x_base}{Optional matrix (or vector) of additional covariates to include
linearly alongside the spline basis. If supplied, it is coerced to a
matrix and column-bound to the design.}

\item{fixedknots}{Integer \eqn{m}: the number of **interior** knots to use.
Internally this determines how many indices are read from \code{knot_bin}.}

\item{polydegree}{Integer polynomial degree of the B-spline segments
(default \code{3L}).}

\item{ic_method}{Character; which information criterion to return:
\code{"BIC"}, \code{"AIC"}, or \code{"AICc"}.}
}
\value{
A single numeric value: the requested information criterion. Lower is
  better. Returns \code{Inf} for invalid chromosomes/inputs.
}
\description{
Computes an information criterion (BIC, AIC, or AICc) for a regression of
\code{y} on a B-spline basis of \code{x} when the number of interior knots is
fixed. This is designed to be used as a fitness/objective function inside a
GA search where the chromosome encodes the **indices** of the interior knots.
}
\details{
The function:
\enumerate{
\item Derives \eqn{m <- as.integer(fixedknots)} and reads indices
  \code{idx <- knot_bin[2L:(1L + m)]}.
\item Validates that \code{idx} are finite, interior, unique, and sorted; the
  corresponding knot locations \code{x_unique[idx]} must lie strictly inside
  \code{range(x)}. Any violation returns \code{Inf} (useful for GA pruning).
\item Builds the design matrix
  \code{cbind(1, x_base, splines::bs(x, degree = polydegree,
  knots = x_unique[idx], Boundary.knots = range(x)))}.
\item Fits OLS via \code{stats::.lm.fit} and computes the selected criterion
  with parameter count \code{p = NCOL(X)} (intercept + \code{x_base} columns
  + spline basis columns).
}
}
\note{
Earlier drafts mistakenly referenced an undefined/global \code{m}.
Always set \code{m <- as.integer(fixedknots)} inside the function to ensure
that exactly \code{fixedknots} interior knots are evaluated.
}
\examples{
library(MASS)
y <- mcycle$accel; x <- mcycle$times
x_unique <- sort(unique(x))
# chromosome encoding 5 interior knot indices:
chrom <- c(5, 24, 30, 46, 49, 69, 95)
fixknotsIC(chrom, y = y, x = x, x_unique = x_unique,
           fixedknots = 5, ic_method = "BIC")
}
\seealso{
[varyknotsIC()], [splines::bs()]
}
