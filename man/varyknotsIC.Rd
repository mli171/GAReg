% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gareg_knots.R
\name{varyknotsIC}
\alias{varyknotsIC}
\title{Information criterion for B-spline regression with a **variable** number of knots}
\usage{
varyknotsIC(
  knot_bin,
  plen = 0,
  y,
  x,
  x_unique,
  x_base = NULL,
  polydegree = 3L,
  ic_method = "BIC"
)
}
\arguments{
\item{knot_bin}{Integer vector (chromosome). The first element is
\eqn{m}, the number of interior knots (\eqn{m \ge 0}). The next
\eqn{m} elements are **indices into** \code{x_unique} selecting interior
knot locations: \code{knot_bin[2L:(1L + m)]}. Indices must be interior,
i.e., in \code{2:(length(x_unique) - 1)}. Any non-finite, duplicate, or
out-of-range index causes the function to return \code{Inf}.}

\item{plen}{Unused placeholder kept for API compatibility; ignored.}

\item{y}{Numeric response vector of length \eqn{n}.}

\item{x}{Numeric predictor (same length as \code{y}) on which the spline
basis is constructed.}

\item{x_unique}{Optional numeric vector of unique candidate knot locations.
If missing or \code{NULL}, defaults to \code{sort(unique(x))}. Must have
at least three values (two boundaries + one interior) to allow any knots.}

\item{x_base}{Optional matrix (or vector) of additional covariates to include
linearly alongside the spline basis; coerced to a matrix if supplied.}

\item{polydegree}{Integer polynomial degree of the B-spline segments
(default \code{3L}).}

\item{ic_method}{Which information criterion to return: \code{"BIC"},
\code{"AIC"}, or \code{"AICc"}.}
}
\value{
A single numeric value: the requested information criterion (lower is
  better). Returns \code{Inf} for invalid chromosomes/inputs.
}
\description{
Evaluates an information criterion (BIC, AIC, or AICc) for a regression of
\code{y} on a B-spline basis of \code{x} where the **number and locations of
interior knots are encoded in the chromosome**. Designed for use as a GA
objective/fitness function.
}
\details{
The function:
\enumerate{
\item Reads \eqn{m <- knot_bin[1]} and the \eqn{m} interior indices
  \code{idx <- knot_bin[2L:(1L + m)]}.
\item Validates that \code{idx} are finite, interior, and that the resulting
  knot locations \code{x_unique[idx]} lie strictly inside \code{range(x)}.
  Violations return \code{Inf} (useful for GA pruning).
\item Builds the design matrix:
  \itemize{
    \item If \eqn{m = 0}: \code{X <- cbind(1, x_base)} (no spline terms).
    \item Else: \code{X <- cbind(1, x_base, splines::bs(
            x, degree = polydegree, knots = x_unique[idx],
            Boundary.knots = range(x)))}.
  }
\item Fits OLS via \code{stats::.lm.fit} and computes the selected criterion
  with parameter count \code{p <- NCOL(X)}.
}

The criteria are computed as:
\deqn{\mathrm{BIC} = n \log(\mathrm{SSRes}/n) + p \log n,}
\deqn{\mathrm{AIC} = n \log(\mathrm{SSRes}/n) + 2p,}
\deqn{\mathrm{AICc} = n \log(\mathrm{SSRes}/n) + 2p +
      \frac{2p(p+1)}{n-p-1},}
where \eqn{\mathrm{SSRes}} is the residual sum of squares and \eqn{p} is the
number of columns in \code{X}.
}
\note{
This function allows \eqn{m=0} (no spline terms) so that the GA can
  compare against a pure-linear baseline (intercept + \code{x_base}).
  Spacing constraints (e.g., minimum distance between indices) should be
  enforced by the GA operators or an external penalty.
}
\examples{
## Example with 'mcycle' data (MASS)
# y <- mcycle$accel; x <- mcycle$times
# x_unique <- sort(unique(x))
# # chromosome encoding m=4 and four interior indices:
# chrom <- c(4, 25, 40, 52, 77)
# varyknotsIC(chrom, y = y, x = x, x_unique = x_unique, ic_method = "BIC")
}
\seealso{
[fixknotsIC()], [splines::bs()]
}
